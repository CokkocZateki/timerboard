{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}
{% block header %}{{ title }}{% endblock %}
{% block body %}
	<style type="text/css">
		label {	font-size: large;
			text-align: right
		}
		input {width: 70%;
			float: right;
		}
	</style>
	<script src="static/countdown.js" type="text/javascript"></script>
	<table class="table table-striped">
		<tr>
			<th>System</th>
			<th>Planet</th>
			<th>Moon</th>
			<th>Owner</th>
			<th>Time</th>
			<th>Remaining</th>
			<th>Notes</th>
		</tr>
		{% for timer in timers %}
		<tr>
			<td><a href="http://evemaps.dotlan.net/search?q={{ timer.system }}">{{ timer.system }}</a></td>
			<td>{{ timer.planet }}</td>
			<td>{{ timer.moon }}</td>
			<td>{{ timer.owner }}</td>
			<td style="width: 110px;">{{ timer.time }} UTC</td>
			<td style="width: 100px;"><span id="remaining.{{ timer.id }}"></span></td>
			<td style="word-break:break-all;">{{ timer.notes }}</td>
		</tr>
		{% endfor %}
	</table>

	<script>
		var timers = {};
		var localOffset = 0; // new Date().getTimezoneOffset() * 60000;
		{% for timer in timers %}
		timers["{{ timer.id }}"] = countdown(
			function(ts) {
				var style = "<font>";
				if (new Date({{ timer.to_unix_time() * 1000 }}) < new Date()) {
					var style="<font color='red'>"
				}
				document.getElementById("remaining.{{ timer.id }}").innerHTML = style+ts.days+"D "+ts.hours+"H "+ts.minutes+"M "+ts.seconds+"S </font>";
			},
			new Date({{ timer.to_unix_time() * 1000 }} + localOffset),
			countdown.DAYS|countdown.HOURS|countdown.MINUTES|countdown.SECONDS);
		{% endfor %}
	</script>
{% endblock %}
